{"version":3,"file":"page-06.js","sources":["../src/js/page06.js"],"sourcesContent":["console.log('page 06');\n////// FSOn 77 19:30 Модуль 11 Урок 2 Фінальний Артем Рисіч 26.04.2023\n\nconst searchForm = document.querySelector(\".js-search\");\nconst addCountry = document.querySelector(\".js-add\");\nconst list = document.querySelector(\".js-list\");\nconst formContainer = document.querySelector(\".js-form-container\");\nconst markup = '<input type=\"text\" name=\"country\">';\n// console.log(searchForm);\n// console.log(addCountry);\n// console.log(list);\n// console.log(formContainer);\n\naddCountry.addEventListener('click', handlerAddInput);\n\nfunction handlerAddInput(){\n    formContainer.insertAdjacentHTML('beforeend', markup);\n\n}\n\nsearchForm.addEventListener('submit', handlerForm);\n\nfunction handlerForm(evt){\n    evt.preventDefault();\n    // console.log(evt.currentTarget);\n    const data = new FormData(evt.currentTarget);\n    // console.log(data.getAll('country'));\n    const arr = data.getAll('country').filter(item => item).map(item => item.trim());\n    //  console.log(arr);\n     getCountries(arr)\n        .then(async resp => {\n        // console.log(resp);\n        const capitals = resp.map(({capital}) => capital[0]);\n        console.log(capitals);\n        const weatherService = await getWeather(capitals);\n        list.innerHTML = createMarkup(weatherService);\n        // console.log(weatherService);\n     })\n     .catch(e => console.log(e))\n     .finally(()=>{\n        formContainer.innerHTML = markup;\n        searchForm.reset();\n     })\n}\nasync function getCountries(arr){\n    const resp = arr.map(async item => {\n        const resp = await fetch(`https://restcountries.com/v3.1/name/${item}`)\n        if(!resp.ok){\n            throw new Error();\n        }\n            return await resp.json();\n    })\n    const data = await Promise.allSettled(resp);\n    console.log(data);\n    const countryObj = data.filter(({status})=> status === 'fulfilled').map(({value})=> value[0]);\n    // console.log(countryObj);\n\n    return countryObj;\n}\n\nasync function getWeather(arr){\n\n    const BASE_URL = 'https://api.weatherapi.com/v1';\n    const API_KEY = '65fc8710104c48e595e140016252406';\n    \n    const resps = arr.map(async city=>{\n        const params = new URLSearchParams({\n        key: API_KEY,\n        q: city,\n        lang: 'uk',\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if(!resp.ok){\n        throw new Error(resp.statusText);\n    }\n        return resp.json();\n    })\n    \n    const data = await Promise.allSettled(resps);\n    const objs = data.filter(({status})=> status === 'fulfilled').map(({value})=> value);\n    // console.log(objs);\n    return objs;\n}\n\nfunction createMarkup(arr){\nreturn arr.map(({current: {temp_c, condition: { text, icon}}, location: {country, name}}) => `\n          <li class=\"\">\n              <div>\n                  <h2>${country}</h2>\n                  <h3>${name}</h3>\n              </div>\n              <img src=\"${icon}\" alt=\"\">\n                <p>${text}</p>\n                <p>${temp_c}</p>\n          </li>\n    `).join('');\n}\n"],"names":["searchForm","addCountry","list","formContainer","markup","handlerAddInput","handlerForm","evt","arr","item","getCountries","resp","capitals","capital","weatherService","getWeather","createMarkup","e","data","status","value","BASE_URL","API_KEY","resps","city","params","temp_c","text","icon","country","name"],"mappings":"oCAAA,QAAQ,IAAI,SAAS,EAGrB,MAAMA,EAAa,SAAS,cAAc,YAAY,EAChDC,EAAa,SAAS,cAAc,SAAS,EAC7CC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAgB,SAAS,cAAc,oBAAoB,EAC3DC,EAAS,qCAMfH,EAAW,iBAAiB,QAASI,CAAe,EAEpD,SAASA,GAAiB,CACtBF,EAAc,mBAAmB,YAAaC,CAAM,CAExD,CAEAJ,EAAW,iBAAiB,SAAUM,CAAW,EAEjD,SAASA,EAAYC,EAAI,CACrBA,EAAI,eAAc,EAIlB,MAAMC,EAFO,IAAI,SAASD,EAAI,aAAa,EAE1B,OAAO,SAAS,EAAE,OAAOE,GAAQA,CAAI,EAAE,IAAIA,GAAQA,EAAK,KAAI,CAAE,EAE9EC,EAAaF,CAAG,EACZ,KAAK,MAAMG,GAAQ,CAEpB,MAAMC,EAAWD,EAAK,IAAI,CAAC,CAAC,QAAAE,CAAO,IAAMA,EAAQ,CAAC,CAAC,EACnD,QAAQ,IAAID,CAAQ,EACpB,MAAME,EAAiB,MAAMC,EAAWH,CAAQ,EAChDV,EAAK,UAAYc,EAAaF,CAAc,CAEpD,CAAM,EACA,MAAMG,GAAK,QAAQ,IAAIA,CAAC,CAAC,EACzB,QAAQ,IAAI,CACVd,EAAc,UAAYC,EAC1BJ,EAAW,MAAK,CACxB,CAAM,CACN,CACA,eAAeU,EAAaF,EAAI,CAC5B,MAAMG,EAAOH,EAAI,IAAI,MAAMC,GAAQ,CAC/B,MAAME,EAAO,MAAM,MAAM,uCAAuCF,CAAI,EAAE,EACtE,GAAG,CAACE,EAAK,GACL,MAAM,IAAI,MAEV,OAAO,MAAMA,EAAK,KAAI,CAClC,CAAK,EACKO,EAAO,MAAM,QAAQ,WAAWP,CAAI,EAC1C,eAAQ,IAAIO,CAAI,EACGA,EAAK,OAAO,CAAC,CAAC,OAAAC,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,EAAM,CAAC,CAAC,CAIhG,CAEA,eAAeL,EAAWP,EAAI,CAE1B,MAAMa,EAAW,gCACXC,EAAU,kCAEVC,EAAQf,EAAI,IAAI,MAAMgB,GAAM,CAC9B,MAAMC,EAAS,IAAI,gBAAgB,CACnC,IAAKH,EACL,EAAGE,EACH,KAAM,IACd,CAAK,EAEKb,EAAO,MAAM,MAAM,GAAGU,CAAQ,iBAAiBI,CAAM,EAAE,EAE7D,GAAG,CAACd,EAAK,GACL,MAAM,IAAI,MAAMA,EAAK,UAAU,EAE/B,OAAOA,EAAK,KAAI,CACxB,CAAK,EAKD,OAHa,MAAM,QAAQ,WAAWY,CAAK,GACzB,OAAO,CAAC,CAAC,OAAAJ,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,CAAK,CAGvF,CAEA,SAASJ,EAAaR,EAAI,CAC1B,OAAOA,EAAI,IAAI,CAAC,CAAC,QAAS,CAAC,OAAAkB,EAAQ,UAAW,CAAE,KAAAC,EAAM,KAAAC,CAAI,CAAC,EAAG,SAAU,CAAC,QAAAC,EAAS,KAAAC,CAAI,CAAC,IAAM;AAAA;AAAA;AAAA,wBAGrED,CAAO;AAAA,wBACPC,CAAI;AAAA;AAAA,0BAEFF,CAAI;AAAA,qBACTD,CAAI;AAAA,qBACJD,CAAM;AAAA;AAAA,KAEtB,EAAE,KAAK,EAAE,CACd"}