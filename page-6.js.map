{"version":3,"file":"page-6.js","sources":["../src/js/page06.js"],"sourcesContent":["console.log('page 06');\n\nconst searchForm = document.querySelector(\".js-search\");\nconst addCountry = document.querySelector(\".js-add\");\nconst list = document.querySelector(\".js-list\");\nconst formContainer = document.querySelector(\".js-form-container\");\n// console.log(searchForm);\n// console.log(addCountry);\n// console.log(list);\n// console.log(formContainer);\n\naddCountry.addEventListener('click', handlerAddInput);\n\nfunction handlerAddInput(){\n    const markup = '<input type=\"text\" name=\"country\">';\n    formContainer.insertAdjacentHTML('beforeend', markup);\n\n}\n\nsearchForm.addEventListener('submit', handlerForm);\n\nfunction handlerForm(evt){\n    evt.preventDefault();\n    // console.log(evt.currentTarget);\n    const data = new FormData(evt.currentTarget);\n    // console.log(data.getAll('country'));\n    const arr = data.getAll('country').filter(item => item).map(item => item.trim());\n    //  console.log(arr);\n     getCountries(arr).then(async resp => {\n        // console.log(resp);\n        const capitals = resp.map(({capital}) => capital[0]);\n        console.log(capitals);\n        const weatherService = await getWeather(capitals);\n        \n        list.innerHTML = createMarkup(weatherService);\n\n        console.log(weatherService);\n     })\n     .catch(e => console.log(e));\n}\nasync function getCountries(arr){\n    const resp = arr.map(async item => {\n        const resp = await fetch(`https://restcountries.com/v3.1/name/${item}`)\n        if(!resp.ok){\n            throw new Error();\n        }\n            return await resp.json();\n    })\n    const data = await Promise.allSettled(resp);\n    const countryObj = data.filter(({status})=> status === 'fulfilled').map(({value})=> value[0]);\n    console.log(countryObj);\n\n    return countryObj;\n}\n\nasync function getWeather(arr){\n\n    const BASE_URL = 'https://api.weatherapi.com/v1';\n    const API_KEY = '65fc8710104c48e595e140016252406';\n    \n    const resps = arr.map(async city=>{\n        const params = new URLSearchParams({\n        key: API_KEY,\n        q: city,\n        lang: 'uk',\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if(!resp.ok){\n        throw new Error(resp.statusText);\n    }\n        return resp.json();\n    })\n    \n    const data = await Promise.allSettled(resps);\n    const objs = data.filter(({status})=> status === 'fulfilled').map(({value})=> value.current);\n    // console.log(objs);\n    return objs;\n}\n\nfunction createMarkup(arr){\nreturn arr.map(() => `\n          <li>\n              <div>\n                  <h2>{country}</h2>\n                  <h3>{name}</h3>\n              </div>\n              <img src=\"{icon}\" alt=\"{text}\">\n                <p>{text}</p>\n                <p>{text}</p>\n          </li>\n    `).join('');\n}\n"],"names":["searchForm","addCountry","list","formContainer","handlerAddInput","handlerForm","evt","arr","item","getCountries","resp","capitals","capital","weatherService","getWeather","createMarkup","e","countryObj","status","value","BASE_URL","API_KEY","resps","city","params"],"mappings":"oCAAA,QAAQ,IAAI,SAAS,EAErB,MAAMA,EAAa,SAAS,cAAc,YAAY,EAChDC,EAAa,SAAS,cAAc,SAAS,EAC7CC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAgB,SAAS,cAAc,oBAAoB,EAMjEF,EAAW,iBAAiB,QAASG,CAAe,EAEpD,SAASA,GAAiB,CAEtBD,EAAc,mBAAmB,YADlB,oCACqC,CAExD,CAEAH,EAAW,iBAAiB,SAAUK,CAAW,EAEjD,SAASA,EAAYC,EAAI,CACrBA,EAAI,eAAc,EAIlB,MAAMC,EAFO,IAAI,SAASD,EAAI,aAAa,EAE1B,OAAO,SAAS,EAAE,OAAOE,GAAQA,CAAI,EAAE,IAAIA,GAAQA,EAAK,KAAI,CAAE,EAE9EC,EAAaF,CAAG,EAAE,KAAK,MAAMG,GAAQ,CAElC,MAAMC,EAAWD,EAAK,IAAI,CAAC,CAAC,QAAAE,CAAO,IAAMA,EAAQ,CAAC,CAAC,EACnD,QAAQ,IAAID,CAAQ,EACpB,MAAME,EAAiB,MAAMC,EAAWH,CAAQ,EAEhDT,EAAK,UAAYa,EAAaF,CAAc,EAE5C,QAAQ,IAAIA,CAAc,CAClC,CAAM,EACA,MAAMG,GAAK,QAAQ,IAAIA,CAAC,CAAC,CAC/B,CACA,eAAeP,EAAaF,EAAI,CAC5B,MAAMG,EAAOH,EAAI,IAAI,MAAMC,GAAQ,CAC/B,MAAME,EAAO,MAAM,MAAM,uCAAuCF,CAAI,EAAE,EACtE,GAAG,CAACE,EAAK,GACL,MAAM,IAAI,MAEV,OAAO,MAAMA,EAAK,KAAI,CAClC,CAAK,EAEKO,GADO,MAAM,QAAQ,WAAWP,CAAI,GAClB,OAAO,CAAC,CAAC,OAAAQ,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,EAAM,CAAC,CAAC,EAC5F,eAAQ,IAAIF,CAAU,EAEfA,CACX,CAEA,eAAeH,EAAWP,EAAI,CAE1B,MAAMa,EAAW,gCACXC,EAAU,kCAEVC,EAAQf,EAAI,IAAI,MAAMgB,GAAM,CAC9B,MAAMC,EAAS,IAAI,gBAAgB,CACnC,IAAKH,EACL,EAAGE,EACH,KAAM,IACd,CAAK,EAEKb,EAAO,MAAM,MAAM,GAAGU,CAAQ,iBAAiBI,CAAM,EAAE,EAE7D,GAAG,CAACd,EAAK,GACL,MAAM,IAAI,MAAMA,EAAK,UAAU,EAE/B,OAAOA,EAAK,KAAI,CACxB,CAAK,EAKD,OAHa,MAAM,QAAQ,WAAWY,CAAK,GACzB,OAAO,CAAC,CAAC,OAAAJ,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,EAAM,OAAO,CAG/F,CAEA,SAASJ,EAAaR,EAAI,CAC1B,OAAOA,EAAI,IAAI,IAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAUhB,EAAE,KAAK,EAAE,CACd"}