{"version":3,"file":"page-8.js","sources":["../src/js/page08.js"],"sourcesContent":["console.log('page 08');\n\nlet toFun  = x => document.querySelector(x);\n\nconst searchForm = toFun('.js-search');\nconst addCountry = toFun('.js-add');\nconst list = toFun('.js-list');\nconst formContainer = toFun('.js-form-container');\nconst markup = '<input type=\"text\" name=\"country\">';\n// console.log(searchForm);\n// console.log(addCountry);\n// console.log(list);\n// console.log(formContainer);\n\nfunction handlerAddInput(){\n   formContainer.insertAdjacentHTML('beforeend', markup);\n}\n\naddCountry.addEventListener('click', handlerAddInput);\nsearchForm.addEventListener('submit', handlerForm);\n\nfunction handlerForm(evt){\n    evt.preventDefault();\n    const data = new FormData(evt.currentTarget);\n    // console.log(data.getAll('country'));\n    const arr = data.getAll('country').filter(item => item).map(item => item.trim());\n    console.log(arr);\n\n    getCounries(arr)\n    .then(async resp => {\n        console.log(resp);\n        const capitals = resp.map(({capital}) =>capital[0]);\n        console.log(capitals);\n        const weatherService = await getWeather(capitals);\n        console.log(weatherService);\n        // getWeather(capitals);\n        list.innerHTML = createMarkup(weatherService);\n    })\n    .catch(e => {\n        console.log(e);\n    })\n    .finally(() => {\n        formContainer.innerHTML = markup;\n        searchForm.reset()\n    })\n}\n\nasync function getCounries(arr){\n    const resps = arr.map(async item =>{\n        const resp = await fetch(`https://restcountries.com/v3.1/name/${item}`);\n                              // `https://restcountries.com/v3.1/name/${item}`\n        if(!resp.ok){\n            throw new Error();\n        }\n        return resp.json();\n    })\n\nconst data = await Promise.allSettled(resps);\n// console.log(data);\nconst countryObj = data.filter(({status}) => status === 'fulfilled' ).map(({value})=> value[0]);\n// console.log(countryObj);\n    return countryObj;\n    \n}\n\nasync function getWeather(arr){\n\n    const BASE_URL = 'https://api.weatherapi.com/v1';\n    const API_KEY = '65fc8710104c48e595e140016252406';\n    \n    const resps = arr.map(async city=>{\n        const params = new URLSearchParams({\n        key: API_KEY,\n        q: city,\n        lang: 'uk',\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if(!resp.ok){\n        throw new Error(resp.statusText);\n    }\n        return resp.json();\n    })\n    const data = await Promise.allSettled(resps);\n    console.log(data);\n    const objs = data.filter(({status})=> status === 'fulfilled').map(({value})=> value);\n    console.log(objs);\n    return objs;\n}\n\nfunction createMarkup(arr){\nreturn arr.map(({current: {temp_c, condition: { text, icon}}, location: {country, name}}) => `\n          <li class=\"\">\n              <div>\n                  <h2>${country}</h2>\n                  <h3>${name}</h3>\n              </div>\n              <img src=\"${icon}\" alt=\"${text}\">\n                <p>${text}</p>\n                <p>${temp_c}</p>\n          </li>\n    `).join('');\n}\n\n"],"names":["toFun","x","searchForm","addCountry","list","formContainer","markup","handlerAddInput","handlerForm","evt","arr","item","getCounries","resp","capitals","capital","weatherService","getWeather","createMarkup","e","resps","status","value","BASE_URL","API_KEY","city","params","data","objs","temp_c","text","icon","country","name"],"mappings":"oCAAA,QAAQ,IAAI,SAAS,EAErB,IAAIA,EAASC,GAAK,SAAS,cAAcA,CAAC,EAE1C,MAAMC,EAAaF,EAAM,YAAY,EAC/BG,EAAaH,EAAM,SAAS,EAC5BI,EAAOJ,EAAM,UAAU,EACvBK,EAAgBL,EAAM,oBAAoB,EAC1CM,EAAS,qCAMf,SAASC,GAAiB,CACvBF,EAAc,mBAAmB,YAAaC,CAAM,CACvD,CAEAH,EAAW,iBAAiB,QAASI,CAAe,EACpDL,EAAW,iBAAiB,SAAUM,CAAW,EAEjD,SAASA,EAAYC,EAAI,CACrBA,EAAI,eAAc,EAGlB,MAAMC,EAFO,IAAI,SAASD,EAAI,aAAa,EAE1B,OAAO,SAAS,EAAE,OAAOE,GAAQA,CAAI,EAAE,IAAIA,GAAQA,EAAK,KAAI,CAAE,EAC/E,QAAQ,IAAID,CAAG,EAEfE,EAAYF,CAAG,EACd,KAAK,MAAMG,GAAQ,CAChB,QAAQ,IAAIA,CAAI,EAChB,MAAMC,EAAWD,EAAK,IAAI,CAAC,CAAC,QAAAE,CAAO,IAAKA,EAAQ,CAAC,CAAC,EAClD,QAAQ,IAAID,CAAQ,EACpB,MAAME,EAAiB,MAAMC,EAAWH,CAAQ,EAChD,QAAQ,IAAIE,CAAc,EAE1BZ,EAAK,UAAYc,EAAaF,CAAc,CACpD,CAAK,EACA,MAAMG,GAAK,CACR,QAAQ,IAAIA,CAAC,CACrB,CAAK,EACA,QAAQ,IAAM,CACXd,EAAc,UAAYC,EAC1BJ,EAAW,MAAK,CACxB,CAAK,CACL,CAEA,eAAeU,EAAYF,EAAI,CAC3B,MAAMU,EAAQV,EAAI,IAAI,MAAMC,GAAO,CAC/B,MAAME,EAAO,MAAM,MAAM,uCAAuCF,CAAI,EAAE,EAEtE,GAAG,CAACE,EAAK,GACL,MAAM,IAAI,MAEd,OAAOA,EAAK,KAAI,CACxB,CAAK,EAMD,OAJS,MAAM,QAAQ,WAAWO,CAAK,GAEnB,OAAO,CAAC,CAAC,OAAAC,CAAM,IAAMA,IAAW,WAAW,EAAG,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,EAAM,CAAC,CAAC,CAI9F,CAEA,eAAeL,EAAWP,EAAI,CAE1B,MAAMa,EAAW,gCACXC,EAAU,kCAEVJ,EAAQV,EAAI,IAAI,MAAMe,GAAM,CAC9B,MAAMC,EAAS,IAAI,gBAAgB,CACnC,IAAKF,EACL,EAAGC,EACH,KAAM,IACd,CAAK,EAEKZ,EAAO,MAAM,MAAM,GAAGU,CAAQ,iBAAiBG,CAAM,EAAE,EAE7D,GAAG,CAACb,EAAK,GACL,MAAM,IAAI,MAAMA,EAAK,UAAU,EAE/B,OAAOA,EAAK,KAAI,CACxB,CAAK,EACKc,EAAO,MAAM,QAAQ,WAAWP,CAAK,EAC3C,QAAQ,IAAIO,CAAI,EAChB,MAAMC,EAAOD,EAAK,OAAO,CAAC,CAAC,OAAAN,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,CAAK,EACnF,eAAQ,IAAIM,CAAI,EACTA,CACX,CAEA,SAASV,EAAaR,EAAI,CAC1B,OAAOA,EAAI,IAAI,CAAC,CAAC,QAAS,CAAC,OAAAmB,EAAQ,UAAW,CAAE,KAAAC,EAAM,KAAAC,CAAI,CAAC,EAAG,SAAU,CAAC,QAAAC,EAAS,KAAAC,CAAI,CAAC,IAAM;AAAA;AAAA;AAAA,wBAGrED,CAAO;AAAA,wBACPC,CAAI;AAAA;AAAA,0BAEFF,CAAI,UAAUD,CAAI;AAAA,qBACvBA,CAAI;AAAA,qBACJD,CAAM;AAAA;AAAA,KAEtB,EAAE,KAAK,EAAE,CACd"}