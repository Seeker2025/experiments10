{"version":3,"file":"page-8.js","sources":["../src/js/page08.js"],"sourcesContent":["console.log('page 08');\n\nlet toFun  = x => document.querySelector(x);\n\nconst searchForm = toFun('.js-search');\nconst addCountry = toFun('.js-add');\nconst list = toFun('.js-list');\nconst formContainer = toFun('.js-form-container');\n// console.log(searchForm);\n// console.log(addCountry);\n// console.log(list);\n// console.log(formContainer);\n\nfunction handlerAddInput(){\n    const markup = '<input type=\"text\" name=\"country\">';\n    formContainer.insertAdjacentHTML('beforeend', markup);\n}\n\naddCountry.addEventListener('click', handlerAddInput);\nsearchForm.addEventListener('submit', handlerForm);\n\nfunction handlerForm(evt){\n    evt.preventDefault();\n    const data = new FormData(evt.currentTarget);\n    // console.log(data.getAll('country'));\n    const arr = data.getAll('country').filter(item => item).map(item => item.trim());\n    console.log(arr);\n\n    getCounries(arr)\n    .then(async resp => {\n        console.log(resp);\n        const capitals = resp.map(({capital}) =>capital[0]);\n        console.log(capitals);\n        const weatherService = await getWeather(capitals);\n        console.log(weatherService);\n        // getWeather(capitals);\n    })\n    .catch(e => {\n        console.log(e);\n    })\n\n}\n\nasync function getCounries(arr){\n    const resps = arr.map(async item =>{\n        const resp = await fetch(`https://restcountries.com/v3.1/name/${item}`);\n                              // `https://restcountries.com/v3.1/name/${item}`\n        if(!resp.ok){\n            throw new Error();\n        }\n        return resp.json();\n    })\n\nconst data = await Promise.allSettled(resps);\n// console.log(data);\nconst countryObj = data.filter(({status}) => status === 'fulfilled' ).map(({value})=> value[0]);\n// console.log(countryObj);\n    return countryObj;\n    \n}\n\nasync function getWeather(arr){\n\n    const BASE_URL = 'https://api.weatherapi.com/v1';\n    const API_KEY = '65fc8710104c48e595e140016252406';\n    \n    const resps = arr.map(async city=>{\n        const params = new URLSearchParams({\n        key: API_KEY,\n        q: city,\n        lang: 'uk',\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if(!resp.ok){\n        throw new Error(resp.statusText);\n    }\n        return resp.json();\n    })\n    const data = await Promise.allSettled(resps);\n    console.log(data);\n    const objs = data.filter(({status})=> status === 'fulfilled').map(({value})=> value);\n    console.log(objs);\n    return objs;\n}\n\nfunction createMarkup(arr){\nreturn arr.map(({temp_c, condition: { text, icon}}) => `\n          <li class=\"\">\n              <div>\n                  <h2>{country}</h2>\n                  <h3>{name}</h3>\n              </div>\n              <img src=\"${icon}\" alt=\"\">\n                <p>${text}</p>\n                <p>${temp_c}</p>\n          </li>\n    `).join('');\n}\n\n"],"names":["toFun","x","searchForm","addCountry","formContainer","handlerAddInput","handlerForm","evt","arr","item","getCounries","resp","capitals","capital","weatherService","getWeather","e","resps","status","value","BASE_URL","API_KEY","city","params","data","objs"],"mappings":"oCAAA,QAAQ,IAAI,SAAS,EAErB,IAAIA,EAASC,GAAK,SAAS,cAAcA,CAAC,EAE1C,MAAMC,EAAaF,EAAM,YAAY,EAC/BG,EAAaH,EAAM,SAAS,EACrBA,EAAM,UAAU,EAC7B,MAAMI,EAAgBJ,EAAM,oBAAoB,EAMhD,SAASK,GAAiB,CAEtBD,EAAc,mBAAmB,YADlB,oCACqC,CACxD,CAEAD,EAAW,iBAAiB,QAASE,CAAe,EACpDH,EAAW,iBAAiB,SAAUI,CAAW,EAEjD,SAASA,EAAYC,EAAI,CACrBA,EAAI,eAAc,EAGlB,MAAMC,EAFO,IAAI,SAASD,EAAI,aAAa,EAE1B,OAAO,SAAS,EAAE,OAAOE,GAAQA,CAAI,EAAE,IAAIA,GAAQA,EAAK,KAAI,CAAE,EAC/E,QAAQ,IAAID,CAAG,EAEfE,EAAYF,CAAG,EACd,KAAK,MAAMG,GAAQ,CAChB,QAAQ,IAAIA,CAAI,EAChB,MAAMC,EAAWD,EAAK,IAAI,CAAC,CAAC,QAAAE,CAAO,IAAKA,EAAQ,CAAC,CAAC,EAClD,QAAQ,IAAID,CAAQ,EACpB,MAAME,EAAiB,MAAMC,EAAWH,CAAQ,EAChD,QAAQ,IAAIE,CAAc,CAElC,CAAK,EACA,MAAME,GAAK,CACR,QAAQ,IAAIA,CAAC,CACrB,CAAK,CAEL,CAEA,eAAeN,EAAYF,EAAI,CAC3B,MAAMS,EAAQT,EAAI,IAAI,MAAMC,GAAO,CAC/B,MAAME,EAAO,MAAM,MAAM,uCAAuCF,CAAI,EAAE,EAEtE,GAAG,CAACE,EAAK,GACL,MAAM,IAAI,MAEd,OAAOA,EAAK,KAAI,CACxB,CAAK,EAMD,OAJS,MAAM,QAAQ,WAAWM,CAAK,GAEnB,OAAO,CAAC,CAAC,OAAAC,CAAM,IAAMA,IAAW,WAAW,EAAG,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,EAAM,CAAC,CAAC,CAI9F,CAEA,eAAeJ,EAAWP,EAAI,CAE1B,MAAMY,EAAW,gCACXC,EAAU,kCAEVJ,EAAQT,EAAI,IAAI,MAAMc,GAAM,CAC9B,MAAMC,EAAS,IAAI,gBAAgB,CACnC,IAAKF,EACL,EAAGC,EACH,KAAM,IACd,CAAK,EAEKX,EAAO,MAAM,MAAM,GAAGS,CAAQ,iBAAiBG,CAAM,EAAE,EAE7D,GAAG,CAACZ,EAAK,GACL,MAAM,IAAI,MAAMA,EAAK,UAAU,EAE/B,OAAOA,EAAK,KAAI,CACxB,CAAK,EACKa,EAAO,MAAM,QAAQ,WAAWP,CAAK,EAC3C,QAAQ,IAAIO,CAAI,EAChB,MAAMC,EAAOD,EAAK,OAAO,CAAC,CAAC,OAAAN,CAAM,IAAKA,IAAW,WAAW,EAAE,IAAI,CAAC,CAAC,MAAAC,CAAK,IAAKA,CAAK,EACnF,eAAQ,IAAIM,CAAI,EACTA,CACX"}